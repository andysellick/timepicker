/* JQuery timepicker plugin - https://github.com/andysellick/timepicker */
!function(t,i){var n=function(t,n){this.elem=t,this.$elem=i(t),this.options=n};n.prototype={init:function(){var t=this;this.popupwrapper,this.popup,this.hour,this.mint,this.ampm,this.display_hour,this.display_mint,this.hourulimit,this.hourdlimit,this.mintulimit,this.mintdlimit,this.settings=i.extend({twentyfourhour:0,initialHour:1,initialMin:0,initialAMPM:"AM",incrementMins:5,increaseText:"+",decreaseText:"-"},this.defaults,this.options),this.timefunctions={setupVariables:function(){t.popupwrapper=t.$elem.closest(".tp-wrapper"),("AM"!=t.settings.initialAMPM||"PM"!=t.settings.initialAMPM)&&(t.settings.initialAMPM="AM"),t.hour=Math.min(t.settings.initialHour,12),t.mint=Math.min(t.settings.initialMin,59),t.incrementMins=Math.min(t.settings.incrementMins,60),t.ampm=t.settings.initialAMPM,t.display_hour=t.hour,t.display_mint=t.mint,t.hourulimit=12,t.hourdlimit=1,t.mintulimit=59,t.mintdlimit=0,t.settings.twentyfourhour&&(t.hourulimit=23,t.hourdlimit=0,t.hour=Math.min(t.settings.initialHour,t.hourulimit)),t.timefunctions.syncTime(),t.timefunctions.updateParent()},createTimePopup:function(){t.popup=i("<div/>").addClass("tp");var n,e=i("<div/>").addClass("timewrap hour"),a=i("<div/>").addClass("timewrap mint"),s=t.timefunctions.getCurrTime();i("<input/>").attr("type","text").addClass("timeinput hour").attr("maxlength",2).val(s[0]).appendTo(e),i("<button/>").addClass("changeval up hour").html(t.settings.increaseText).attr("data-action","1").appendTo(e),i("<button/>").addClass("changeval down hour").html(t.settings.decreaseText).attr("data-action","-1").appendTo(e),i("<input/>").attr("type","text").addClass("timeinput mint").attr("maxlength",2).val(s[1]).appendTo(a),i("<button/>").addClass("changeval up mint").html(t.settings.increaseText).attr("data-action","1").appendTo(a),i("<button/>").addClass("changeval down mint").html(t.settings.decreaseText).attr("data-action","-1").appendTo(a),t.settings.twentyfourhour||(n=i("<div/>").addClass("timewrap ampm"),i("<input/>").attr("type","text").addClass("timeinput ampm").attr("maxlength",2).val(s[2]).appendTo(n),i("<button/>").addClass("changeval up ampm").html(t.settings.increaseText).attr("data-action","am").appendTo(n),i("<button/>").addClass("changeval down ampm").html(t.settings.decreaseText).attr("data-action","pm").appendTo(n)),t.popup.append(e,a,n).appendTo(t.popupwrapper)},showTimePopup:function(){t.popup.show()},removeTimePopup:function(){t.popup&&t.popup.hide()},updateAll:function(){t.timefunctions.syncTime(),t.timefunctions.updateChildren(),t.timefunctions.updateParent()},changeMinutes:function(i,n){var e=t.timefunctions.changeNum(t.mint,t.mintulimit,t.mintdlimit,n*i);t.mint=e[0],e[1]&&t.timefunctions.changeHours(e[1],1)},changeHours:function(i,n){var e=t.hour,a=t.timefunctions.changeNum(t.hour,t.hourulimit,t.hourdlimit,n*i);t.hour=a[0],t.settings.twentyfourhour||(11==e&&12==t.hour&&t.timefunctions.switchAMPM(),12==e&&11==t.hour&&t.timefunctions.switchAMPM())},changeNum:function(t,i,n,e){t+=e;var a=0;return t>i&&(t-=i,0==n&&(t-=1),a=1),n>t&&(t+=i,0==n&&(t+=1),a=-1),[t,a]},syncTime:function(){t.display_hour=t.hour,t.display_mint=t.mint,t.settings.twentyfourhour&&t.display_hour<10&&(t.display_hour="0"+t.hour),t.display_mint<10&&(t.display_mint="0"+t.mint)},updateChildren:function(){var n=[t.display_hour,t.display_mint,t.ampm],e=0;t.popup&&t.popup.find("input").each(function(){i(this).val(n[e]),e++})},updateParent:function(){t.$elem.val(t.settings.twentyfourhour?t.display_hour+":"+t.display_mint:t.display_hour+":"+t.display_mint+" "+t.ampm)},switchAMPM:function(){t.ampm="AM"==t.ampm?"PM":"AM",t.timefunctions.updateAll()},getCurrTime:function(){var i=t.$elem.val(),n=i.split(":"),e=n[1].split(" "),a=e[1];return t.settings.twentyfourhour?[n[0],e[0]]:[n[0],e[0],a]},createListeners:function(){t.$elem.on("focus",function(){t.popup?t.timefunctions.showTimePopup():t.timefunctions.createTimePopup()}),i("body,html").on("click",t.timefunctions.removeTimePopup),i("body").on("click",".tp",function(t){t.stopPropagation()}),t.$elem.on("click",function(t){t.stopPropagation()}),t.popupwrapper.on("click",".changeval.hour",function(n){n.preventDefault(),t.timefunctions.changeHours(parseInt(i(this).data("action")),1),t.timefunctions.updateAll()}),t.popupwrapper.on("click",".changeval.mint",function(n){n.preventDefault(),t.timefunctions.changeMinutes(parseInt(i(this).data("action")),t.settings.incrementMins),t.timefunctions.updateAll()}),t.popupwrapper.on("click",".changeval.ampm",function(i){i.preventDefault(),t.timefunctions.switchAMPM(),t.timefunctions.updateAll()}),t.popupwrapper.on("focus",".timeinput",function(){t.timefunctions.updateAll()}),t.popupwrapper.on("keyup",".timeinput",function(n){var e=0,a=n.keyCode||n.which,s=t.hour,u=t.timefunctions.changeHours,o=1;if(i(this).hasClass("mint")&&(s=t.mint,o=t.settings.incrementMins,u=t.timefunctions.changeMinutes),38==a)u(1,o),t.timefunctions.updateAll();else if(40==a)u(-1,o),t.timefunctions.updateAll();else{var p=parseInt(i(this).val());isNaN(p)||(p>s?(e=1,o=p-s):s>p&&(e=-1,o=s-p),u(o,e),t.timefunctions.syncTime(),t.timefunctions.updateParent())}})}},t.timefunctions.setupVariables(),t.timefunctions.createListeners(),i(".timeinput").on("click",function(){})}},i.fn.timepicker=function(t){return this.each(function(){new n(this,t).init()})},t.Plugin=n}(window,jQuery);